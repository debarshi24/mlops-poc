version: 0.2

env:
  variables:
    S3_PREFIX_FOR_DEPLOYMENT: "models/deployed"

phases:
  install:
    runtime-versions:
      python: 3.9
    commands:
      - echo "Install phase started"
      - pip install --upgrade pip
      - pip install -r requirements.txt

  pre_build:
    commands:
      - echo "Training phase started on `date`"
      - aws --version
      - echo "S3_BUCKET=$S3_BUCKET"
      - echo "DATA_S3_URI=$DATA_S3_URI"
      - echo "MODEL_PACKAGE_GROUP_NAME=$MODEL_PACKAGE_GROUP_NAME"

  build:
    commands:
      - echo "Build started on `date`"
      - python ml_pipeline.py

  post_build:
    commands:
      - echo "Build completed on `date`"
      - echo "Artifacts produced:"
      - ls -la

artifacts:
  files:
    - '**/*'
  name: MLOpsOutput
